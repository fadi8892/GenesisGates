{% extends "base.html" %}

{% block content %}
<h2 class="mb-3">Welcome, {{ user.name }}</h2>
<p>Your membership plan: <strong>{{ user.membership_plan|capitalize }}</strong></p>

<h3 class="mt-4">Plan Features</h3>
<ul class="list-group list-group-flush mb-4">
    {% for key, value in features.items() %}
    <li class="list-group-item"><strong>{{ key }}:</strong> {{ value }}</li>
    {% endfor %}
</ul>

{% if error %}
<div class="alert alert-danger">{{ error }}</div>
{% endif %}

<h3>Your Trees</h3>
{% if trees %}
<div class="table-responsive">
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">Name</th>
                <th scope="col">Description</th>
                <th scope="col">Persons</th>
                <th scope="col">Action</th>
            </tr>
        </thead>
        <tbody>
            {% for tree in trees %}
            <tr>
                <td>{{ tree.name }}</td>
                <td>{{ tree.description }}</td>
                <td>{{ tree.person_count }}</td>
                <td>
                    <a href="/tree/{{ tree.id }}" class="btn btn-sm btn-primary">Open</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p>You haven't created any trees yet. Start by creating one below.</p>
{% endif %}

<h4 class="mt-4">Create a new tree</h4>
<form method="post" action="/create-tree" class="mt-3">
    <div class="mb-3">
        <label for="name" class="form-label">Tree name</label>
        <input type="text" class="form-control" id="name" name="name" required>
    </div>
    <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea class="form-control" id="description" name="description" rows="3"></textarea>
    </div>
    <button type="submit" class="btn btn-success">Create Tree</button>
</form>
{% endblock %}
